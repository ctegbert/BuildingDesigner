<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Colton Egbert - 3D Building Designer</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        #container { display: flex; height: 100vh; }
        #sidebar {
            width: 250px;
            padding: 20px;
            background: linear-gradient(135deg, #f4f4f4, #e0e0e0);
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 1;
            transition: width 0.3s;
        }
        #price { font-size: 16px; font-weight: bold; color: #0077ff; }
        @media (max-width: 768px) {
            #sidebar { width: 200px; }
            #container { flex-direction: column; }
            #sidebar { height: auto; }
        }
    </style>
</head>
<body>
    <nav>
        <a href="home.html">Home</a>
        <a href="about.html">About</a>
        <a href="index.html">Design</a>
    </nav>
    <div id="container">
        <div id="sidebar">
            <div class="title">3D Building Designer</div>

            <label>Zoom:</label>
            <input type="range" id="zoomControl" min="10" max="100" value="30">

            <label>Building Width:</label>
            <input type="range" id="widthControl" min="5" max="30" value="10">

            <label>Building Height:</label>
            <input type="range" id="heightControl" min="5" max="20" value="5">

            <label>Building Length:</label>
            <input type="range" id="lengthControl" min="10" max="50" value="15">

            <label>Building Color:</label>
            <input type="color" id="colorControl" value="#0077ff">

            <label>Roof Style:</label>
            <select id="roofControl">
                <option value="flat">Flat</option>
                <option value="gabled">Gabled</option>
            </select>

            <div id="price">Estimated Cost: $0</div>

            <button id="exportPDF">Export to PDF</button>
            <button id="snapshot">Download Snapshot</button>
        </div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(30, 15, 40);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0xeeeeee);
        document.getElementById('container').appendChild(renderer.domElement);

        let building, roof;
        const material = new THREE.MeshStandardMaterial({ color: 0x0077ff });
        updateBuilding();

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 10, 5);
        scene.add(directionalLight);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.screenSpacePanning = false;
        controls.maxPolarAngle = Math.PI / 2;

        function updateBuilding() {
            const width = +document.getElementById("widthControl").value;
            const height = +document.getElementById("heightControl").value;
            const length = +document.getElementById("lengthControl").value;
            const roofStyle = document.getElementById("roofControl").value;

            scene.remove(building);
            scene.remove(roof);

            const baseGeometry = new THREE.BoxGeometry(width, height, length);
            building = new THREE.Mesh(baseGeometry, material);
            scene.add(building);

            if (roofStyle === "flat") {
                const roofGeometry = new THREE.BoxGeometry(width + 1, 0.5, length + 1);
                roof = new THREE.Mesh(roofGeometry, material);
                roof.position.y = height / 2 + 0.25;
            } else if (roofStyle === "gabled") {
                const roofGeometry = new THREE.ConeGeometry(width / 2, 2, 4);
                roof = new THREE.Mesh(roofGeometry, material);
                roof.position.y = height / 2 + 1;
                roof.rotation.y = Math.PI / 4;
            }
            scene.add(roof);

            updatePrice(width, height, length);
        }

        function updateZoom() {
            const zoom = +document.getElementById("zoomControl").value;
            camera.position.set(zoom, zoom / 2, zoom * 1.2);
        }

        function updateColor() {
            const color = document.getElementById("colorControl").value;
            material.color.set(color);
        }

        function updatePrice(width, height, length) {
            const volume = width * height * length;
            const cost = volume * 50; // $50 per cubic unit
            document.getElementById("price").textContent = `Estimated Cost: $${cost.toLocaleString()}`;
            return cost;
        }

        function exportPDF() {
            const width = document.getElementById("widthControl").value;
            const height = document.getElementById("heightControl").value;
            const length = document.getElementById("lengthControl").value;
            const color = document.getElementById("colorControl").value;
            const roofStyle = document.getElementById("roofControl").value;
            const cost = updatePrice(width, height, length);

            const doc = new jsPDF();
            doc.setFontSize(16);
            doc.text("Building Design Summary", 10, 10);
            doc.setFontSize(12);
            doc.text(`Width: ${width}m`, 10, 20);
            doc.text(`Height: ${height}m`, 10, 30);
            doc.text(`Length: ${length}m`, 10, 40);
            doc.text(`Color: ${color}`, 10, 50);
            doc.text(`Roof Style: ${roofStyle}`, 10, 60);
            doc.text(`Estimated Cost: $${cost.toLocaleString()}`, 10, 70);
            doc.save("building_design.pdf");
        }

        function takeSnapshot() {
            renderer.render(scene, camera);
            const imgData = renderer.domElement.toDataURL("image/png");
            const link = document.createElement("a");
            link.href = imgData;
            link.download = "building_snapshot.png";
            link.click();
        }

        document.getElementById("widthControl").addEventListener("input", updateBuilding);
        document.getElementById("heightControl").addEventListener("input", updateBuilding);
        document.getElementById("lengthControl").addEventListener("input", updateBuilding);
        document.getElementById("zoomControl").addEventListener("input", updateZoom);
        document.getElementById("colorControl").addEventListener("input", updateColor);
        document.getElementById("roofControl").addEventListener("change", updateBuilding);
        document.getElementById("exportPDF").addEventListener("click", exportPDF);
        document.getElementById("snapshot").addEventListener("click", takeSnapshot);

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener("resize", () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>